!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.LightRPC={})}(this,function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var n=void 0;if("undefined"!=typeof window&&window.setTimeout){var i=window;n=i.setTimeout}else{var c=require("timers");n=c.setTimeout}var u=function(t){function n(t,o){e(this,n);var i=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return i.name="JSONRPCError",i.error=o,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(i,i.constructor):i.stack=new Error(t).stack,i}return o(n,Error),n}(),a=function(t){function n(t){e(this,n);var o=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,t));return o.name="JSONRPCNoResult","function"==typeof Error.captureStackTrace?Error.captureStackTrace(o,o.constructor):o.stack=new Error(t).stack,o}return o(n,Error),n}(),f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p=void 0;if("undefined"!=typeof window&&window.fetch){var l=window;p=l.fetch}else p=require("cross-fetch");t.createClient=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!=typeof t)throw new Error("InvalidArgument: address has to ba a string");if("object"!==(void 0===e?"undefined":s(e)))throw new Error("InvalidArgument: options has to be an object");var r=f({timeout:5e3},e),o=0;return{send:function(e,i,c){if("string"!=typeof e)throw new Error("InvalidArgument: method has to be a string");if(!(i instanceof Array))throw new Error("InvalidArgument: params has to be an array");if("function"!=typeof c)throw new Error("InvalidArgument: callback has to be a function");var f={id:o,jsonrpc:"2.0",method:e,params:i};o+=1,function(t,e){return new Promise(function(r,o){n(function(){o(new Error("Request has timed out. It should take no longer than "+t+"ms."))},t),e.then(r,o)})}(r.timeout,function(e){return p(t,{body:JSON.stringify(e),method:"post",mode:"cors"})}(f)).then(function(t){return t.json()}).then(function(t){if(t.error)throw new u("Response contains error. See error property for details.",t.err);if(!t.result)throw new a("Response doesn't contain result");return t}).then(function(t){return c(null,t.result),t}).catch(function(t){return c(t,null)})}}},Object.defineProperty(t,"__esModule",{value:!0})});
